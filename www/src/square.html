<!DOCTYPE html>
<!--
  square.html — 广场页面 HTML 结构

  功能:
  - 显示所有用户发布的消息
  - 支持用户上传图片和编辑文字
  - 显示发送者头像
  - 保持与其他页面一致的UI风格
-->
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="theme-color" content="#ffffff" />
    <title>广场</title>
    <!-- 页面样式表 -->
    <link rel="stylesheet" href="../statics/css/square.css" />
  </head>
  <body>
    <!-- 主应用容器 -->
    <main class="app" aria-label="广场">
      <!-- 顶部标题栏 -->
      <header class="topbar">
        <div class="title">广场</div>
        <button class="refresh-btn" id="refreshBtn" aria-label="刷新">
          <ion-icon ios="refresh-outline" md="refresh-sharp" aria-hidden="true"></ion-icon>
        </button>
      </header>

      <!-- 发布触发按钮 -->
      <section class="publish-trigger-section">
        <button class="publish-trigger-btn" id="publishTriggerBtn">
          <ion-icon ios="add-circle-outline" md="add-circle-sharp" aria-hidden="true"></ion-icon>
          <span>分享想法</span>
        </button>
      </section>

      <!-- 发布消息区域 - 默认隐藏 -->
      <section class="publish-section" id="publishSection" style="display: none;" aria-label="发布消息">
        <div class="publish-card">
            <div class="publish-header">
            <div class="user-info">
              <div class="user-avatar" id="userAvatar">
                <div class="avatar-initials" id="avatarInitials">JB</div>
                <img id="avatarImage" class="avatar-image" style="display: none;" alt="用户头像">
              </div>
              <div class="user-name" id="userName">Junxi Bao</div>
            </div>
            <div class="publish-header-actions">
              <button class="cancel-btn" id="cancelBtn">
                <ion-icon ios="close-outline" md="close-sharp" aria-hidden="true"></ion-icon>
                取消
              </button>
              <button class="publish-btn" id="publishBtn" disabled>
                <ion-icon ios="send-outline" md="send-sharp" aria-hidden="true"></ion-icon>
                发布
              </button>
            </div>
          </div>
          
          <div class="publish-content">
            <textarea 
              id="messageText" 
              class="message-textarea" 
              placeholder="分享你的想法..."
              maxlength="500"
            ></textarea>
            
            <!-- 图片上传区域 - 与diet页面保持一致 -->
            <div class="image-upload-section">
              <h4 class="upload-title">上传图片</h4>
              <div class="image-upload-container">
                <div class="image-upload-btn" id="addImageBtn">
                  <div class="upload-icon">+</div>
                  <div class="upload-text">(上传图片)</div>
                </div>
                <div class="uploaded-images" id="uploadedImages"></div>
              </div>
            </div>
          </div>
          
          <div class="publish-actions">
            <div class="char-count">
              <span id="charCount">0</span>/500
            </div>
            <div class="actions-right">
              <button class="anonymous-btn" id="anonymousBtn" aria-pressed="false" title="匿名发布">匿名发布</button>
            </div>
          </div>
        </div>
      </section>

      <!-- 消息列表区域 -->
      <section class="messages-section" aria-label="消息列表">
        <div class="messages-header">
          <h2>最新动态</h2>
          <div class="message-count" id="messageCount">0 条消息</div>
        </div>
        
        <!-- 加载状态 -->
        <div class="loading-state" id="loadingState">
          <div class="loading-spinner"></div>
          <p>加载中...</p>
        </div>
        
        <!-- 消息列表 -->
        <div class="messages-list" id="messagesList">
          <!-- 消息将通过JavaScript动态添加 -->
        </div>
        
        <!-- 空状态 -->
        <div class="empty-state" id="emptyState" style="display: none;">
          <div class="empty-icon">
            <ion-icon ios="chatbubbles-outline" md="chatbubbles-sharp" aria-hidden="true"></ion-icon>
          </div>
          <h3>还没有消息</h3>
          <p>成为第一个分享想法的人吧！</p>
        </div>
      </section>

      <!-- 隐藏的文件输入 -->
      <input type="file" id="imageFileInput" accept="image/*" style="display: none;">
    </main>
  </body>
</html>


